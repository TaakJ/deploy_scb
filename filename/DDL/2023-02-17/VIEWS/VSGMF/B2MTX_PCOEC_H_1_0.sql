CREATE OR REPLACE VIEW P1VSGMF.B2MTX_PCOEC_H_1_0 (
  EDW_RECORD_NO,
  PCOLE_REC_TYPE,
  PCOLE_CORP,
  PCOLE_BATCH_NUMBER,
  PCOLE_SEQUENCE,
  PCOLE_HDR_DEPARTMENT,
  PCOLE_HDR_BOX_NBR,
  PCOLE_HDR_TRAN_CODE,
  PCOLE_HDR_OPENED_DATE,
  FILLER_1,
  PCOLE_HDR_TRAN_DATE,
  FILLER_2,
  PCOLE_HDR_STATUS,
  PCOLE_HDR_CURR_SEQ,
  PCOLE_HDR_MERCH_ID,
  PCOLE_HDR_MERCH_STATUS,
  PCOLE_HDR_CURRENCY_CODE,
  PCOLE_HDR_XCHG_RATE,
  PCOLE_HDR_PREV_STATUS,
  PCOLE_HDR_OPER_OPEN,
  PCOLE_HDR_OPER_LAST_UPD,
  PCOLE_HDR_TERM,
  PCOLE_HDR_CNTL_ITEMS,
  PCOLE_HDR_CNTL_AMOUNT,
  PCOLE_HDR_ORIG_ITEMS,
  PCOLE_HDR_ORIG_AMOUNT,
  PCOLE_HDR_APPRV_ITEMS,
  PCOLE_HDR_APPRV_AMOUNT,
  PCOLE_BANK_NUMBER,
  PCOLE_HDR_MC_IRD,
  FILLER_3,
  dl_data_dt)
AS select
0 as EDW_RECORD_NO ,
COALESCE(TRIM(PCOLE_REC_TYPE),' ') as PCOLE_REC_TYPE,
COALESCE(TRIM(PCOLE_CORP),' ') as PCOLE_CORP,
PCOLE_BATCH_NUMBER,
PCOLE_SEQUENCE,
COALESCE(TRIM(PCOLE_HDR_DEPARTMENT),' ') as PCOLE_HDR_DEPARTMENT,
PCOLE_HDR_BOX_NBR,
COALESCE(TRIM(PCOLE_HDR_TRAN_CODE),' ') as PCOLE_HDR_TRAN_CODE,
right('000000000'||replace(PCOLE_HDR_OPENED_DATE,'-',''),9) as PCOLE_HDR_OPENED_DATE, /*PCOLE_HDR_OPENED_DATE (FORMAT '9(9)')*/
COALESCE(TRIM(FILLER_1),' ') as FILLER_1,
right('000000000'||replace(PCOLE_HDR_TRAN_DATE,'-',''),9) as PCOLE_HDR_TRAN_DATE, /*PCOLE_HDR_TRAN_DATE (FORMAT '9(9)')*/
COALESCE(TRIM(FILLER_2),' ') as FILLER_2,
COALESCE(TRIM(PCOLE_HDR_STATUS),' ') as PCOLE_HDR_STATUS,
PCOLE_HDR_CURR_SEQ,
COALESCE(TRIM(PCOLE_HDR_MERCH_ID),' ') as PCOLE_HDR_MERCH_ID,
PCOLE_HDR_MERCH_STATUS,
COALESCE(TRIM(PCOLE_HDR_CURRENCY_CODE),' ') as PCOLE_HDR_CURRENCY_CODE,
replace(FORMAT_NUMBER_TD(PCOLE_HDR_XCHG_RATE,'000.00000',9,'Y'), '.', '') as PCOLE_HDR_XCHG_RATE, -- PCOLE_HDR_XCHG_RATE,
COALESCE(TRIM(PCOLE_HDR_PREV_STATUS),' ') as PCOLE_HDR_PREV_STATUS,
COALESCE(TRIM(PCOLE_HDR_OPER_OPEN),' ') as PCOLE_HDR_OPER_OPEN,
COALESCE(TRIM(PCOLE_HDR_OPER_LAST_UPD),' ') as PCOLE_HDR_OPER_LAST_UPD,
COALESCE(TRIM(PCOLE_HDR_TERM),' ') as PCOLE_HDR_TERM,
PCOLE_HDR_CNTL_ITEMS,
PCOLE_HDR_CNTL_AMOUNT,
PCOLE_HDR_ORIG_ITEMS,
PCOLE_HDR_ORIG_AMOUNT,
PCOLE_HDR_APPRV_ITEMS,
PCOLE_HDR_APPRV_AMOUNT,
COALESCE(TRIM(PCOLE_BANK_NUMBER),' ') as PCOLE_BANK_NUMBER,
COALESCE(TRIM(PCOLE_HDR_MC_IRD),' ') as PCOLE_HDR_MC_IRD,
COALESCE(TRIM(FILLER_3),' ') as FILLER_3,
dl_data_dt

from p1dlprst.b2k_pcoec_hdr_1_0
