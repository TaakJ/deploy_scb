CREATE OR REPLACE VIEW P1VSGMF.B2K_BCVISAR_1_0 (
  EDW_RECORD_NO,
  VR_TRAN_CODE,
  VR_TRAN_CODE_SUB,
  VR_TRAN_CODE_QUAL,
  VR_TRAN_COMP_SEQ_NO,
  VR_ACCT_NO,
  VR_NEW_ACCT_BIN,
  VR_NEW_ACCT_SEQ,
  VR_DRAFT_ACNO_EXTENSION,
  VR_FLOOR_LIMIT_IND,
  VR_CWB_CRB_IND,
  VR_LCS_IND,
  VR_VISA_MICRO_REF_NUM,
  VR_VISA_REF_FORMAT,
  VR_VISA_REF_BIN,
  VR_VISA_REF_BIN_A,
  VR_VISA_REF_CAPTURE_DATE,
  VR_VISA_REF_SEQ_NUM,
  VR_VISA_REF_CKDIGIT,
  VR_TRACE_NUMBER,
  VR_ACQUIRER_MEMBER_ID,
  VR_PURCH_DATE,
  VR_TRANS_AMOUNT,
  VR_DEST_CURRENCY_CODE,
  VR_ENTRY_AMOUNT,
  VR_ENTRY_AMOUNT_INTEGER,
  VR_SOURCE_CURRENCY_CODE,
  VR_MERCH_NAME,
  VR_AIRLINE_NAME,
  VR_TICKET_NUMBER,
  VR_MERCH_CITY,
  VR_MERCHANT_COUNTRY_CODE,
  VR_MERCH_CLASS,
  VR_TMP_MERCH_ZIP_CODE,
  VR_MERCH_STATE,
  VR_REQUESTED_PMT_SVC,
  VR_USAGE_CODE,
  VR_REASON_CODE,
  VR_SETTLEMENT_FLAG,
  VR_PAYMENT_SERVICE_IND,
  VR_AUTH_NO,
  VR_VISA_AUTH1,
  VR_VISA_AUTH2,
  VR_TMP_POS_TERM_CAPABILITY,
  VR_INTERNATIONAL_FEE_INDIC,
  VR_TMP_CARDHOLDER_ID_METHOD,
  VR_COLLECTION_ONLY_FLAG,
  VR_TMP_POS_ENTRY_MODE,
  VR_CENTRAL_PROCESS_DATE,
  VR_REIM_ATTRIBUTE,
  VR_TCR1_TRAN_CODE,
  VR_TCR1_TRAN_CODE_QUAL,
  VR_TCR1_TRAN_COMP_SEQ,
  VR_TCR1_CHARGEBACK_REF_NUM,
  VR_TCR1_DOCUMENTATION_IND,
  VR_TCR1_MESSAGE_TEXT,
  VR_TCR1_SPECIAL_COND_IND,
  VR_TCR1_SPEC_COND_1,
  VR_TCR1_SPEC_COND_2,
  VR_TCR1_FEE_PROG_IND,
  VR_TCR1_ISSUER_CHARGE_FLD,
  VR_TCR1_RESERVED,
  VR_TCR1_CARD_ACCEPTOR_ID,
  VR_TCR1_TERMINAL_ID,
  VR_TCR1_NONSETL_REIM_FEE,
  VR_MAIL_PHONE_IND,
  VR_SPECIAL_CGBK_IND,
  VR_TCR1_INTERFACE_TRACE_NUM,
  VR_TCR1_CARDHOLDER_ACT_TERM,
  VR_TCR1_PREPAID_CARD_IND,
  VR_TCR1_SVC_DEVELOPMENT,
  VR_AVS_RESPONSE_CODE,
  VR_TCR1_AUTH_SOURCE,
  VR_PURCH_ID_FORMAT,
  VR_TCR1_ATM_ACCT_SELECTION,
  VR_TCR1_INSTALL_PMT_CNT,
  VR_TCR1_INSTALL_PMT_CNT_NUM,
  VR_TCR1_ITEM_DESCRIPTOR,
  VR_TCR1_CASH_BACK,
  VR_TCR1_CHIP_COND_CODE,
  VR_TCR1_POS_ENVIRONMENT,
  VR_TCR2_TRAN_CODE,
  VR_TCR2_TRAN_CODE_QUAL,
  VR_TCR2_TRAN_COMP_SEQ,
  VR_TCR2_FIELDS,
  VR_TCR3_TRAN_CODE,
  VR_TCR3_TRAN_CODE_QUAL,
  VR_TCR3_TRAN_COMP_SEQ,
  VR_TCR3_BUSINESS_FORMAT_CODE,
  VR_TCR3_AI_PSNGR_NAME,
  VR_TCR3_AI_DEPARTURE_DATE,
  VR_TCR3_AI_ORIG_CITY_AIRPORT,
  VR_TCR3_AI_CARRIER_1,
  VR_TCR3_AI_SERVICE_CLASS_1,
  VR_TCR3_AI_STOPOVER_CODE_1,
  VR_TCR3_AI_DEST_CITY_AIRPT_1,
  VR_TCR3_AI_CARRIER_2,
  VR_TCR3_AI_SERVICE_CLASS_2,
  VR_TCR3_AI_STOPOVER_CODE_2,
  VR_TCR3_AI_DEST_CITY_AIRPT_2,
  VR_TCR3_AI_CARRIER_3,
  VR_TCR3_AI_SERVICE_CLASS_3,
  VR_TCR3_AI_STOPOVER_CODE_3,
  VR_TCR3_AI_DEST_CITY_AIRPT_3,
  VR_TCR3_AI_CARRIER_4,
  VR_TCR3_AI_SERVICE_CLASS_4,
  VR_TCR3_AI_STOPOVER_CODE_4,
  VR_TCR3_AI_DEST_CITY_AIRPT_4,
  VR_TCR3_AI_TRAVEL_AGENCY_CODE,
  VR_TCR3_AI_TRAVEL_AGENCY_NAME,
  VR_TCR3_RESTRICT_TICKET_IND,
  VR_TCR4_TRAN_CODE,
  VR_TCR4_TRAN_CODE_QUAL,
  VR_TCR4_TRAN_COMP_SEQ,
  VR_TCR4_BUS_FMT_CODE,
  VR_TCR4_DEBIT_PRODUCT_CODE,
  VR_TCR4_CONTACT,
  VR_TCR4_ADJUSTMENT_INDIC,
  VR_TCR4_PLUS_MIS_CAS_CODE,
  VR_TCR4_SURCHG_AMT,
  VR_TCR4_SURCHG_DB_CR_INDIC,
  VR_TCR4_PROMOTION_TYPE,
  VR_TCR4_PROMOTION_CODE,
  VR_TCR5_TRAN_CODE,
  VR_TCR5_TRAN_CODE_QUAL,
  VR_TCR5_TRAN_COMP_SEQ,
  VR_TCR5_TRANS_ID,
  VR_TCR5_AUTH_AMOUNT,
  VR_TCR5_AUTH_CURRENCY_CODE,
  VR_TCR5_AUTH_RESP_CODE,
  VR_TCR5_VALIDATE_CODE,
  VR_TCR5_EXC_TRAN_ID_REASON,
  VR_TCR5_CRS_PROCESS_CODE,
  VR_TCR5_CHGBK_CONDITION_CODE,
  VR_TCR5_MULT_CLEARING_SEQ,
  VR_TCR5_MULT_CLEARING_CNT,
  VR_TCR5_MKT_AUTH_DATA_INDIC,
  VR_TCR5_TOTAL_AUTH_AMOUNT,
  VR_TCR5_INFO_IND,
  VR_TCR5_MERCH_PHONE,
  VR_TCR5_ADDITIONAL_IND,
  VR_TCR5_MERCH_VOLUME_IND,
  VR_TCR5_MERCH_VERIF_VALUE,
  VR_TCR5_INTCHG_FEE_AMOUNT,
  VR_TCR5_INTCHG_FEE_SIGN,
  VR_TCR5_CURR_SRCE_BASE,
  VR_TCR5_CURR_BASE_DEST,
  VR_TCR5_ISSUER_ISA_AMT_FLD,
  VR_TCR5_PRODUCT_IDENTIFIER,
  VR_TCR5_PROGRAM_IDENTIFIER,
  VR_TCR5_CVV2_RESULT_CODE,
  VR_TCR6_TRAN_CODE,
  VR_TCR6_TRAN_CODE_QUAL,
  VR_TCR6_TRAN_COMP_SEQ,
  VR_TCR6_SALES_TAX_NO_DEC,
  VR_TCR6_SALES_TAX_AMOUNT,
  VR_TCR6_SALES_TAX_INDIC,
  VR_TCR6_NATNL_TAX_NO_DEC,
  VR_TCR6_NATNL_TAX_AMOUNT,
  VR_TCR6_NATNL_TAX_INDIC,
  VR_TCR6_MERCH_VAT_REG_NBR,
  VR_TCR6_CUST_VAT_REG_NBR,
  VR_TCR6_MERCH_ORDER_NBR,
  VR_TCR6_SUMM_COMM_CODE,
  VR_TCR6_OTHER_TAX_NO_DEC,
  VR_TCR6_OTHER_TAX_AMOUNT,
  VR_TCR6_MESSAGE_ID,
  START_DT,
  END_DT,
  RECORD_DELETED_FLAG,
  CTL_ID,
  INS_PROC_NAME,
  INS_TXF_BATCHID,
  UPD_PROC_NAME,
  UPD_TXF_BATCHID,
  VR_TRAN_FLAG,
  VR_CREDIT_FLAG,
  VR_INTER_FLAG,
  VR_BIN_8,
  TRANSACTION_DATE)
AS SELECT
  STGMERGE.EDW_RECORD_NO,
  STGMERGE.VR_TRAN_CODE,
  STGMERGE.VR_TRAN_CODE_SUB,
  STGMERGE.VR_TRAN_CODE_QUAL,
  STGMERGE.VR_TRAN_COMP_SEQ_NO,
  STGMERGE.VR_ACCT_NO,
  STGMERGE.VR_NEW_ACCT_BIN,
  STGMERGE.VR_NEW_ACCT_SEQ,
  STGMERGE.VR_DRAFT_ACNO_EXTENSION,
  STGMERGE.VR_FLOOR_LIMIT_IND,
  STGMERGE.VR_CWB_CRB_IND,
  STGMERGE.VR_LCS_IND,
  STGMERGE.VR_VISA_MICRO_REF_NUM,
  STGMERGE.VR_VISA_REF_FORMAT,
  STGMERGE.VR_VISA_REF_BIN,
  STGMERGE.VR_VISA_REF_BIN_A,
  STGMERGE.VR_VISA_REF_CAPTURE_DATE,
  STGMERGE.VR_VISA_REF_SEQ_NUM,
  STGMERGE.VR_VISA_REF_CKDIGIT,
  STGMERGE.VR_TRACE_NUMBER,
  STGMERGE.VR_ACQUIRER_MEMBER_ID,
  STGMERGE.VR_PURCH_DATE,
  STGMERGE.VR_TRANS_AMOUNT,
  STGMERGE.VR_DEST_CURRENCY_CODE,
  STGMERGE.VR_ENTRY_AMOUNT,
  STGMERGE.VR_ENTRY_AMOUNT_INTEGER,
  STGMERGE.VR_SOURCE_CURRENCY_CODE,
  STGMERGE.VR_MERCH_NAME,
  STGMERGE.VR_AIRLINE_NAME,
  STGMERGE.VR_TICKET_NUMBER,
  STGMERGE.VR_MERCH_CITY,
  STGMERGE.VR_MERCHANT_COUNTRY_CODE,
  STGMERGE.VR_MERCH_CLASS,
  STGMERGE.VR_TMP_MERCH_ZIP_CODE,
  STGMERGE.VR_MERCH_STATE,
  STGMERGE.VR_REQUESTED_PMT_SVC,
  STGMERGE.VR_USAGE_CODE,
  STGMERGE.VR_REASON_CODE,
  STGMERGE.VR_SETTLEMENT_FLAG,
  STGMERGE.VR_PAYMENT_SERVICE_IND,
  STGMERGE.VR_AUTH_NO,
  STGMERGE.VR_VISA_AUTH1,
  STGMERGE.VR_VISA_AUTH2,
  STGMERGE.VR_TMP_POS_TERM_CAPABILITY,
  STGMERGE.VR_INTERNATIONAL_FEE_INDIC,
  STGMERGE.VR_TMP_CARDHOLDER_ID_METHOD,
  STGMERGE.VR_COLLECTION_ONLY_FLAG,
  STGMERGE.VR_TMP_POS_ENTRY_MODE,
  STGMERGE.VR_CENTRAL_PROCESS_DATE,
  STGMERGE.VR_REIM_ATTRIBUTE,
  STGMERGE.VR_TCR1_TRAN_CODE,
  STGMERGE.VR_TCR1_TRAN_CODE_QUAL,
  STGMERGE.VR_TCR1_TRAN_COMP_SEQ,
  STGMERGE.VR_TCR1_CHARGEBACK_REF_NUM,
  STGMERGE.VR_TCR1_DOCUMENTATION_IND,
  STGMERGE.VR_TCR1_MESSAGE_TEXT,
  STGMERGE.VR_TCR1_SPECIAL_COND_IND,
  STGMERGE.VR_TCR1_SPEC_COND_1,
  STGMERGE.VR_TCR1_SPEC_COND_2,
  STGMERGE.VR_TCR1_FEE_PROG_IND,
  STGMERGE.VR_TCR1_ISSUER_CHARGE_FLD,
  STGMERGE.VR_TCR1_RESERVED,
  STGMERGE.VR_TCR1_CARD_ACCEPTOR_ID,
  STGMERGE.VR_TCR1_TERMINAL_ID,
  STGMERGE.VR_TCR1_NONSETL_REIM_FEE,
  STGMERGE.VR_MAIL_PHONE_IND,
  STGMERGE.VR_SPECIAL_CGBK_IND,
  STGMERGE.VR_TCR1_INTERFACE_TRACE_NUM,
  STGMERGE.VR_TCR1_CARDHOLDER_ACT_TERM,
  STGMERGE.VR_TCR1_PREPAID_CARD_IND,
  STGMERGE.VR_TCR1_SVC_DEVELOPMENT,
  STGMERGE.VR_AVS_RESPONSE_CODE,
  STGMERGE.VR_TCR1_AUTH_SOURCE,
  STGMERGE.VR_PURCH_ID_FORMAT,
  STGMERGE.VR_TCR1_ATM_ACCT_SELECTION,
  STGMERGE.VR_TCR1_INSTALL_PMT_CNT,
  STGMERGE.VR_TCR1_INSTALL_PMT_CNT_NUM,
  STGMERGE.VR_TCR1_ITEM_DESCRIPTOR,
  STGMERGE.VR_TCR1_CASH_BACK,
  STGMERGE.VR_TCR1_CHIP_COND_CODE,
  STGMERGE.VR_TCR1_POS_ENVIRONMENT,
  STGMERGE.VR_TCR2_TRAN_CODE,
  STGMERGE.VR_TCR2_TRAN_CODE_QUAL,
  STGMERGE.VR_TCR2_TRAN_COMP_SEQ,
  STGMERGE.VR_TCR2_FIELDS,
  STGMERGE.VR_TCR3_TRAN_CODE,
  STGMERGE.VR_TCR3_TRAN_CODE_QUAL,
  STGMERGE.VR_TCR3_TRAN_COMP_SEQ,
  STGMERGE.VR_TCR3_BUSINESS_FORMAT_CODE,
  STGMERGE.VR_TCR3_AI_PSNGR_NAME,
  STGMERGE.VR_TCR3_AI_DEPARTURE_DATE,
  STGMERGE.VR_TCR3_AI_ORIG_CITY_AIRPORT,
  STGMERGE.VR_TCR3_AI_CARRIER_1,
  STGMERGE.VR_TCR3_AI_SERVICE_CLASS_1,
  STGMERGE.VR_TCR3_AI_STOPOVER_CODE_1,
  STGMERGE.VR_TCR3_AI_DEST_CITY_AIRPT_1,
  STGMERGE.VR_TCR3_AI_CARRIER_2,
  STGMERGE.VR_TCR3_AI_SERVICE_CLASS_2,
  STGMERGE.VR_TCR3_AI_STOPOVER_CODE_2,
  STGMERGE.VR_TCR3_AI_DEST_CITY_AIRPT_2,
  STGMERGE.VR_TCR3_AI_CARRIER_3,
  STGMERGE.VR_TCR3_AI_SERVICE_CLASS_3,
  STGMERGE.VR_TCR3_AI_STOPOVER_CODE_3,
  STGMERGE.VR_TCR3_AI_DEST_CITY_AIRPT_3,
  STGMERGE.VR_TCR3_AI_CARRIER_4,
  STGMERGE.VR_TCR3_AI_SERVICE_CLASS_4,
  STGMERGE.VR_TCR3_AI_STOPOVER_CODE_4,
  STGMERGE.VR_TCR3_AI_DEST_CITY_AIRPT_4,
  STGMERGE.VR_TCR3_AI_TRAVEL_AGENCY_CODE,
  STGMERGE.VR_TCR3_AI_TRAVEL_AGENCY_NAME,
  STGMERGE.VR_TCR3_RESTRICT_TICKET_IND,
  STGMERGE.VR_TCR4_TRAN_CODE,
  STGMERGE.VR_TCR4_TRAN_CODE_QUAL,
  STGMERGE.VR_TCR4_TRAN_COMP_SEQ,
  STGMERGE.VR_TCR4_BUS_FMT_CODE,
  STGMERGE.VR_TCR4_DEBIT_PRODUCT_CODE,
  STGMERGE.VR_TCR4_CONTACT,
  STGMERGE.VR_TCR4_ADJUSTMENT_INDIC,
  STGMERGE.VR_TCR4_PLUS_MIS_CAS_CODE,
  STGMERGE.VR_TCR4_SURCHG_AMT,
  STGMERGE.VR_TCR4_SURCHG_DB_CR_INDIC,
  STGMERGE.VR_TCR4_PROMOTION_TYPE,
  STGMERGE.VR_TCR4_PROMOTION_CODE,
  STGMERGE.VR_TCR5_TRAN_CODE,
  STGMERGE.VR_TCR5_TRAN_CODE_QUAL,
  STGMERGE.VR_TCR5_TRAN_COMP_SEQ,
  STGMERGE.VR_TCR5_TRANS_ID,
  STGMERGE.VR_TCR5_AUTH_AMOUNT,
  STGMERGE.VR_TCR5_AUTH_CURRENCY_CODE,
  STGMERGE.VR_TCR5_AUTH_RESP_CODE,
  STGMERGE.VR_TCR5_VALIDATE_CODE,
  STGMERGE.VR_TCR5_EXC_TRAN_ID_REASON,
  STGMERGE.VR_TCR5_CRS_PROCESS_CODE,
  STGMERGE.VR_TCR5_CHGBK_CONDITION_CODE,
  STGMERGE.VR_TCR5_MULT_CLEARING_SEQ,
  STGMERGE.VR_TCR5_MULT_CLEARING_CNT,
  STGMERGE.VR_TCR5_MKT_AUTH_DATA_INDIC,
  STGMERGE.VR_TCR5_TOTAL_AUTH_AMOUNT,
  STGMERGE.VR_TCR5_INFO_IND,
  STGMERGE.VR_TCR5_MERCH_PHONE,
  STGMERGE.VR_TCR5_ADDITIONAL_IND,
  STGMERGE.VR_TCR5_MERCH_VOLUME_IND,
  STGMERGE.VR_TCR5_MERCH_VERIF_VALUE,
  STGMERGE.VR_TCR5_INTCHG_FEE_AMOUNT,
  STGMERGE.VR_TCR5_INTCHG_FEE_SIGN,
  STGMERGE.VR_TCR5_CURR_SRCE_BASE,
  STGMERGE.VR_TCR5_CURR_BASE_DEST,
  STGMERGE.VR_TCR5_ISSUER_ISA_AMT_FLD,
  STGMERGE.VR_TCR5_PRODUCT_IDENTIFIER,
  STGMERGE.VR_TCR5_PROGRAM_IDENTIFIER,
  STGMERGE.VR_TCR5_CVV2_RESULT_CODE,
  STGMERGE.VR_TCR6_TRAN_CODE,
  STGMERGE.VR_TCR6_TRAN_CODE_QUAL,
  STGMERGE.VR_TCR6_TRAN_COMP_SEQ,
  STGMERGE.VR_TCR6_SALES_TAX_NO_DEC,
  STGMERGE.VR_TCR6_SALES_TAX_AMOUNT,
  STGMERGE.VR_TCR6_SALES_TAX_INDIC,
  STGMERGE.VR_TCR6_NATNL_TAX_NO_DEC,
  STGMERGE.VR_TCR6_NATNL_TAX_AMOUNT,
  STGMERGE.VR_TCR6_NATNL_TAX_INDIC,
  STGMERGE.VR_TCR6_MERCH_VAT_REG_NBR,
  STGMERGE.VR_TCR6_CUST_VAT_REG_NBR,
  STGMERGE.VR_TCR6_MERCH_ORDER_NBR,
  STGMERGE.VR_TCR6_SUMM_COMM_CODE,
  STGMERGE.VR_TCR6_OTHER_TAX_NO_DEC,
  STGMERGE.VR_TCR6_OTHER_TAX_AMOUNT,
  STGMERGE.VR_TCR6_MESSAGE_ID,
  STGMERGE.START_DT,
  STGMERGE.END_DT,
  STGMERGE.RECORD_DELETED_FLAG,
  STGMERGE.CTL_ID,
  STGMERGE.INS_PROC_NAME,
  STGMERGE.INS_TXF_BATCHID,
  STGMERGE.UPD_PROC_NAME,
  STGMERGE.UPD_TXF_BATCHID,
  STGMERGE.VR_TRAN_FLAG,
  STGMERGE.VR_CREDIT_FLAG,
  STGMERGE.VR_INTER_FLAG,
  STGMERGE.VR_BIN_8,
  COALESCE(DEFAULT_DATE,to_date('1000-01-02', 'yyyy-MM-dd')) as TRANSACTION_DATE
from p1dutedw.char_calendar as cc
right join
(
  select 
    EDW_RECORD_NO,
    VR_TRAN_FLAG,
    VR_TRAN_CODE,
    VR_TRAN_CODE_SUB,
    VR_TRAN_CODE_QUAL,
    VR_TRAN_COMP_SEQ_NO,
    VR_ACCT_NO,
    VR_NEW_ACCT_BIN,
    VR_NEW_ACCT_SEQ,
    VR_DRAFT_ACNO_EXTENSION,
    VR_FLOOR_LIMIT_IND,
    VR_CWB_CRB_IND,
    VR_LCS_IND,
    VR_VISA_MICRO_REF_NUM,
    VR_VISA_REF_FORMAT,
    VR_VISA_REF_BIN,
    VR_VISA_REF_BIN_A,
    VR_VISA_REF_CAPTURE_DATE,
    VR_VISA_REF_SEQ_NUM,
    VR_VISA_REF_CKDIGIT,
    VR_TRACE_NUMBER,
    VR_ACQUIRER_MEMBER_ID,
    VR_PURCH_DATE,
    VR_TRANS_AMOUNT,
    VR_DEST_CURRENCY_CODE,
    VR_ENTRY_AMOUNT,
    VR_ENTRY_AMOUNT_INTEGER,
    VR_SOURCE_CURRENCY_CODE,
    VR_MERCH_NAME,
    VR_AIRLINE_NAME,
    VR_TICKET_NUMBER,
    VR_MERCH_CITY,
    VR_MERCHANT_COUNTRY_CODE,
    VR_MERCH_CLASS,
    VR_TMP_MERCH_ZIP_CODE,
    VR_MERCH_STATE,
    VR_REQUESTED_PMT_SVC,
    VR_USAGE_CODE,
    VR_REASON_CODE,
    VR_SETTLEMENT_FLAG,
    VR_PAYMENT_SERVICE_IND,
    VR_AUTH_NO,
    VR_VISA_AUTH1,
    VR_VISA_AUTH2,
    VR_TMP_POS_TERM_CAPABILITY,
    VR_INTERNATIONAL_FEE_INDIC,
    VR_TMP_CARDHOLDER_ID_METHOD,
    VR_COLLECTION_ONLY_FLAG,
    VR_TMP_POS_ENTRY_MODE,
    VR_CENTRAL_PROCESS_DATE,
    VR_REIM_ATTRIBUTE,
    VR_TCR1_TRAN_CODE,
    VR_TCR1_TRAN_CODE_QUAL,
    VR_TCR1_TRAN_COMP_SEQ,
    VR_TCR1_CHARGEBACK_REF_NUM,
    VR_TCR1_DOCUMENTATION_IND,
    VR_TCR1_MESSAGE_TEXT,
    VR_TCR1_SPECIAL_COND_IND,
    VR_TCR1_SPEC_COND_1,
    VR_TCR1_SPEC_COND_2,
    VR_TCR1_FEE_PROG_IND,
    VR_TCR1_ISSUER_CHARGE_FLD,
    VR_TCR1_RESERVED,
    VR_TCR1_CARD_ACCEPTOR_ID,
	VR_TCR1_TERMINAL_ID,
	VR_TCR1_NONSETL_REIM_FEE,
	VR_MAIL_PHONE_IND,
	VR_SPECIAL_CGBK_IND,
	VR_TCR1_INTERFACE_TRACE_NUM,
	VR_TCR1_CARDHOLDER_ACT_TERM,
	VR_TCR1_PREPAID_CARD_IND,
	VR_TCR1_SVC_DEVELOPMENT,
	VR_AVS_RESPONSE_CODE,
	VR_TCR1_AUTH_SOURCE,
	VR_PURCH_ID_FORMAT,
	VR_TCR1_ATM_ACCT_SELECTION,
	VR_TCR1_INSTALL_PMT_CNT,
	VR_TCR1_INSTALL_PMT_CNT_NUM,
	VR_TCR1_ITEM_DESCRIPTOR,
	VR_TCR1_CASH_BACK,
	VR_TCR1_CHIP_COND_CODE,
	VR_TCR1_POS_ENVIRONMENT,
	VR_TCR2_TRAN_CODE,
	VR_TCR2_TRAN_CODE_QUAL,
	VR_TCR2_TRAN_COMP_SEQ,
	VR_TCR2_FIELDS,
	VR_TCR3_TRAN_CODE,
	VR_TCR3_TRAN_CODE_QUAL,
	VR_TCR3_TRAN_COMP_SEQ,
	VR_TCR3_BUSINESS_FORMAT_CODE,
	VR_TCR3_AI_PSNGR_NAME,
	VR_TCR3_AI_DEPARTURE_DATE,
	VR_TCR3_AI_ORIG_CITY_AIRPORT,
	VR_TCR3_AI_CARRIER_1,
	VR_TCR3_AI_SERVICE_CLASS_1,
	VR_TCR3_AI_STOPOVER_CODE_1,
	VR_TCR3_AI_DEST_CITY_AIRPT_1,
	VR_TCR3_AI_CARRIER_2,
	VR_TCR3_AI_SERVICE_CLASS_2,
	VR_TCR3_AI_STOPOVER_CODE_2,
	VR_TCR3_AI_DEST_CITY_AIRPT_2,
	VR_TCR3_AI_CARRIER_3,
	VR_TCR3_AI_SERVICE_CLASS_3,
	VR_TCR3_AI_STOPOVER_CODE_3,
	VR_TCR3_AI_DEST_CITY_AIRPT_3,
	VR_TCR3_AI_CARRIER_4,
	VR_TCR3_AI_SERVICE_CLASS_4,
	VR_TCR3_AI_STOPOVER_CODE_4,
	VR_TCR3_AI_DEST_CITY_AIRPT_4,
	VR_TCR3_AI_TRAVEL_AGENCY_CODE,
	VR_TCR3_AI_TRAVEL_AGENCY_NAME,
	VR_TCR3_RESTRICT_TICKET_IND,
	VR_TCR4_TRAN_CODE,
	VR_TCR4_TRAN_CODE_QUAL,
	VR_TCR4_TRAN_COMP_SEQ,
	VR_TCR4_BUS_FMT_CODE,
	VR_TCR4_DEBIT_PRODUCT_CODE,
	VR_TCR4_CONTACT,
	VR_TCR4_ADJUSTMENT_INDIC,
	VR_TCR4_PLUS_MIS_CAS_CODE,
	VR_TCR4_SURCHG_AMT,
	VR_TCR4_SURCHG_DB_CR_INDIC,
	VR_TCR4_PROMOTION_TYPE,
	VR_TCR4_PROMOTION_CODE,
	VR_TCR5_TRAN_CODE,
	VR_TCR5_TRAN_CODE_QUAL,
	VR_TCR5_TRAN_COMP_SEQ,
	VR_TCR5_TRANS_ID,
	VR_TCR5_AUTH_AMOUNT,
	VR_TCR5_AUTH_CURRENCY_CODE,
	VR_TCR5_AUTH_RESP_CODE,
	VR_TCR5_VALIDATE_CODE,
	VR_TCR5_EXC_TRAN_ID_REASON,
	VR_TCR5_CRS_PROCESS_CODE,
	VR_TCR5_CHGBK_CONDITION_CODE,
	VR_TCR5_MULT_CLEARING_SEQ,
	VR_TCR5_MULT_CLEARING_CNT,
	VR_TCR5_MKT_AUTH_DATA_INDIC,
	VR_TCR5_TOTAL_AUTH_AMOUNT,
	VR_TCR5_INFO_IND,
	VR_TCR5_MERCH_PHONE,
	VR_TCR5_ADDITIONAL_IND,
	VR_TCR5_MERCH_VOLUME_IND,
	VR_TCR5_MERCH_VERIF_VALUE,
	VR_TCR5_INTCHG_FEE_AMOUNT,
	VR_TCR5_INTCHG_FEE_SIGN,
	VR_TCR5_CURR_SRCE_BASE,
	VR_TCR5_CURR_BASE_DEST,
	VR_TCR5_ISSUER_ISA_AMT_FLD,
	VR_TCR5_PRODUCT_IDENTIFIER,
	VR_TCR5_PROGRAM_IDENTIFIER,
	VR_TCR5_CVV2_RESULT_CODE,
	VR_TCR6_TRAN_CODE,
	VR_TCR6_TRAN_CODE_QUAL,
	VR_TCR6_TRAN_COMP_SEQ,
	VR_TCR6_SALES_TAX_NO_DEC,
	VR_TCR6_SALES_TAX_AMOUNT,
	VR_TCR6_SALES_TAX_INDIC,
	VR_TCR6_NATNL_TAX_NO_DEC,
	VR_TCR6_NATNL_TAX_AMOUNT,
	VR_TCR6_NATNL_TAX_INDIC,
	VR_TCR6_MERCH_VAT_REG_NBR,
	VR_TCR6_CUST_VAT_REG_NBR,
	VR_TCR6_MERCH_ORDER_NBR,
	VR_TCR6_SUMM_COMM_CODE,
	VR_TCR6_OTHER_TAX_NO_DEC,
	VR_TCR6_OTHER_TAX_AMOUNT,
	VR_TCR6_MESSAGE_ID,
	START_DT,
	END_DT,
	RECORD_DELETED_FLAG,
	CTL_ID,
	INS_PROC_NAME,
	INS_TXF_BATCHID,
	UPD_PROC_NAME,
	UPD_TXF_BATCHID,
	VR_CREDIT_FLAG,
	VR_INTER_FLAG,
	VR_BIN_8
  FROM p1dsgedw.B2K_BCVISAR_1_0_T1
) as stgmerge
on coalesce 
(
  case
    when substr(vr_purch_date,1,2) > substr(start_dt,6,2)
      then
        substr(start_dt,1,4)-1 || vr_purch_date
      else
        substr(start_dt,1,4) || vr_purch_date
  end, 'NA'
) = cc.cdt_yyyymmdd
