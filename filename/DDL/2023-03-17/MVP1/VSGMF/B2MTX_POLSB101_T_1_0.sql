CREATE OR REPLACE VIEW P1VSGMF.B2MTX_POLSB101_T_1_0 (
  EDW_RECORD_NO,
  OLSLOG_TYPE,
  OLSLOG_MRCH_CORP_NO,
  OLSLOG_MRCH_NO,
  OLSLOG_MRCH_CARD_TYPE,
  OLSLOG_MRCH_TYPE_CODE,
  OLSLOG_TERMINAL_ID,
  OLSLOG_BATCH_NO,
  OLSLOG_BRANCH_NO,
  OLSLOG_REC_CONTROL,
  OLSLOG_CARD_NO,
  OLSLOG_MSG_TYPE,
  OLSLOG_TRAN_TYPE,
  OLSLOG_AUTH_CODE,
  OLSLOG_DATE,
  OLSLOG_TIME,
  OLSLOG_RDM_AMT,
  OLSLOG_CREDIT_AMT,
  OLSLOG_TRACE_NO,
  OLSLOG_NET_OR_GROSS,
  OLSLOG_VSA_TYPE,
  OLSLOG_MCA_TYPE,
  OLSLOG_JCB_TYPE,
  OLSLOG_LOC_TYPE,
  OLSLOG_VSA_RATE,
  OLSLOG_MCA_RATE,
  OLSLOG_JCB_RATE,
  OLSLOG_LOC_RATE,
  OLSLOG_TERM_NAME,
  OLSLOG_POS_ENTRY,
  OLSLOG_MRCH_ACCT_NO,
  OLSLOG_MCA_AFF_TYPE,
  OLSLOG_MCA_AFF_RATE,
  OLSLOG_VSA_AFF_TYPE,
  OLSLOG_VSA_AFF_RATE,
  OLSLOG_AB_FLAG,
  OLSLOG_JCB_AFF_TYPE,
  OLSLOG_JCB_AFF_RATE,
  OLSLOG_CODE_TEXT,
  OLSLOG_POINT,
  OLSLOG_RDM_TYPE,
  OLSLOG_MCE_TYPE,
  OLSLOG_MCE_RATE,
  OLSLOG_GROUP_MRCH_NEW,
  OLSLOG_FILLER,
  START_DT,
  END_DT,
  RECORD_DELETED_FLAG,
  CTL_ID,
  INS_PROC_NAME,
  INS_TXF_BATCHID,
  UPD_PROC_NAME,
  UPD_TXF_BATCHID,
  BK_PARTY_002_008,
  BM_M12950_006,
  TRANSACTION_DATE)
AS SELECT
STGMERGE.EDW_RECORD_NO,
STGMERGE.OLSLOG_TYPE,
STGMERGE.OLSLOG_MRCH_CORP_NO,
STGMERGE.OLSLOG_MRCH_NO,
STGMERGE.OLSLOG_MRCH_CARD_TYPE,
STGMERGE.OLSLOG_MRCH_TYPE_CODE,
STGMERGE.OLSLOG_TERMINAL_ID,
STGMERGE.OLSLOG_BATCH_NO,
STGMERGE.OLSLOG_BRANCH_NO,
STGMERGE.OLSLOG_REC_CONTROL,
STGMERGE.OLSLOG_CARD_NO,
STGMERGE.OLSLOG_MSG_TYPE,
STGMERGE.OLSLOG_TRAN_TYPE,
STGMERGE.OLSLOG_AUTH_CODE,
STGMERGE.OLSLOG_DATE,
STGMERGE.OLSLOG_TIME,
/* STGMERGE.OLSLOG_RDM_AMT, */
right('000000000000'||cast(STGMERGE.OLSLOG_RDM_AMT*100 as int),12) AS OLSLOG_RDM_AMT,
/* STGMERGE.OLSLOG_CREDIT_AMT, */
right('000000000000'||cast(STGMERGE.OLSLOG_CREDIT_AMT*100 as int),12) AS OLSLOG_CREDIT_AMT,
STGMERGE.OLSLOG_TRACE_NO,
STGMERGE.OLSLOG_NET_OR_GROSS,
STGMERGE.OLSLOG_VSA_TYPE,
STGMERGE.OLSLOG_MCA_TYPE,
STGMERGE.OLSLOG_JCB_TYPE,
STGMERGE.OLSLOG_LOC_TYPE,
STGMERGE.OLSLOG_VSA_RATE,
STGMERGE.OLSLOG_MCA_RATE,
STGMERGE.OLSLOG_JCB_RATE,
STGMERGE.OLSLOG_LOC_RATE,
STGMERGE.OLSLOG_TERM_NAME,
STGMERGE.OLSLOG_POS_ENTRY,
STGMERGE.OLSLOG_MRCH_ACCT_NO,
STGMERGE.OLSLOG_MCA_AFF_TYPE,
STGMERGE.OLSLOG_MCA_AFF_RATE,
STGMERGE.OLSLOG_VSA_AFF_TYPE,
STGMERGE.OLSLOG_VSA_AFF_RATE,
STGMERGE.OLSLOG_AB_FLAG,
STGMERGE.OLSLOG_JCB_AFF_TYPE,
STGMERGE.OLSLOG_JCB_AFF_RATE,
STGMERGE.OLSLOG_CODE_TEXT,
STGMERGE.OLSLOG_POINT,
STGMERGE.OLSLOG_RDM_TYPE,
STGMERGE.OLSLOG_MCE_TYPE,
STGMERGE.OLSLOG_MCE_RATE,
STGMERGE.OLSLOG_GROUP_MRCH_NEW,
STGMERGE.OLSLOG_FILLER,
STGMERGE.START_DT,
STGMERGE.END_DT,
STGMERGE.RECORD_DELETED_FLAG,
STGMERGE.CTL_ID,
STGMERGE.INS_PROC_NAME,
STGMERGE.INS_TXF_BATCHID,
STGMERGE.UPD_PROC_NAME,
STGMERGE.UPD_TXF_BATCHID,
COALESCE(TRIM(STGMERGE.OLSLOG_MRCH_CORP_NO),' ')
||'_'||COALESCE(TRIM(STGMERGE.OLSLOG_MRCH_NO),' ')
AS BK_PARTY_002_008,
STGMERGE.OLSLOG_TRAN_TYPE AS BM_M12950_006,
COALESCE(DEFAULT_DATE,to_date('1000-01-02', 'yyyy-MM-dd')) as TRANSACTION_DATE
FROM  P1DUTEDW.CHAR_CALENDAR CC
RIGHT OUTER JOIN
(
  SELECT
    EDW_RECORD_NO,
    OLSLOG_TYPE,
    OLSLOG_MRCH_CORP_NO,
    OLSLOG_MRCH_NO,
    OLSLOG_MRCH_CARD_TYPE,
    OLSLOG_MRCH_TYPE_CODE,
    OLSLOG_TERMINAL_ID,
    OLSLOG_BATCH_NO,
    OLSLOG_BRANCH_NO,
    OLSLOG_REC_CONTROL,
    OLSLOG_CARD_NO,
    OLSLOG_MSG_TYPE,
    OLSLOG_TRAN_TYPE,
    OLSLOG_AUTH_CODE,
    OLSLOG_DATE,
    OLSLOG_TIME,
    OLSLOG_RDM_AMT,
    OLSLOG_CREDIT_AMT,
    OLSLOG_TRACE_NO,
    OLSLOG_NET_OR_GROSS,
    OLSLOG_VSA_TYPE,
    OLSLOG_MCA_TYPE,
    OLSLOG_JCB_TYPE,
    OLSLOG_LOC_TYPE,
    OLSLOG_VSA_RATE,
    OLSLOG_MCA_RATE,
    OLSLOG_JCB_RATE,
    OLSLOG_LOC_RATE,
    OLSLOG_TERM_NAME,
    OLSLOG_POS_ENTRY,
    OLSLOG_MRCH_ACCT_NO,
    OLSLOG_MCA_AFF_TYPE,
    OLSLOG_MCA_AFF_RATE,
    OLSLOG_VSA_AFF_TYPE,
    OLSLOG_VSA_AFF_RATE,
    OLSLOG_AB_FLAG,
    OLSLOG_JCB_AFF_TYPE,
    OLSLOG_JCB_AFF_RATE,
    OLSLOG_CODE_TEXT,
    OLSLOG_POINT,
    OLSLOG_RDM_TYPE,
    OLSLOG_MCE_TYPE,
    OLSLOG_MCE_RATE,
    OLSLOG_GROUP_MRCH_NEW,
    OLSLOG_FILLER,
    START_DT,
    END_DT,
    RECORD_DELETED_FLAG,
    CTL_ID,
    INS_PROC_NAME,
    INS_TXF_BATCHID,
    UPD_PROC_NAME,
    UPD_TXF_BATCHID
  FROM P1DSGEDW.B2MTX_POLSB101_T_1_0_T1
) STGMERGE

ON COALESCE(CAST('20'||OLSLOG_DATE as char(8)),'NA') = CC.CDT_YYYYMMDD
