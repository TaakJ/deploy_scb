CREATE OR REPLACE VIEW P1VSGMF.B2MTX_BCOMC_T_1_0 (
  EDW_RECORD_NO,
  BCOLM_REC_TYPE,
  BCOLM_CORP,
  BCOLM_BATCH_NUMBER,
  BCOLM_SEQUENCE,
  BCOLM_DUAL_TYPE,
  BCOLM_TRAN_CHECK_NUMBER,
  BCOLM_TRAN_ACCOUNT,
  BCOLM_TRAN_DT,
  BCOLM_TRAN_AMOUNT,
  BCOLM_TRAN_REASON_CODE,
  BCOLM_TRAN_AUTH_NUMBER,
  BCOLM_TRAN_DESCRIPTION,
  BCOLM_TRAN_DESC_CODE,
  BCOLM_TRAN_DISPOSITION,
  BCOLM_TRAN_OPER,
  BCOLM_ONLINE_MON_IND,
  BCOLM_ORIG_POST_DT,
  BCOLM_ORIG_TRAN_DT,
  BCOLM_ORIG_AGGR_EFF_DT,
  BCOLM_ORIG_ACCRUAL_IND,
  BCOLM_ORIG_TRAN_INIT_ACCR,
  FILLER_1,
  BCOLM_ORIG_TRAN_CODE,
  BCOLM_ORIG_REASON_CODE,
  BCOLM_ORIG_REF_NUMBER,
  BCOLM_DISPUTE_OPTION,
  BCOLM_DISPUTE_RESOLVE_OPTION,
  BCOLM_PLAN_ID,
  BCOLM_PLAN_SEQ,
  BCOLM_STORE_NBR,
  BCOLM_PMTS_FIXED,
  BCOLM_PAYMENTS_NBR,
  BCOLM_USER_CODE,
  BCOLM_INVOICE_NBR,
  BCOLM_MULTI_INVOICE_IND,
  BCOLM_USE_ORIG_REF_NBR,
  BCOLM_FRONT_LOAD_INTEREST_AMT,
  BCOLM_FRONT_LOAD_INSURANCE_AMT,
  BCOLM_FRONT_LOAD_INTEREST_RATE,
  BCOLM_TRAN_SOURCE_ID,
  BCOLM_SIC_CODE,
  FILLER_2,
  START_DT,
  END_DT,
  RECORD_DELETED_FLAG,
  CTL_ID,
  INS_PROC_NAME,
  INS_TXF_BATCHID,
  UPD_PROC_NAME,
  UPD_TXF_BATCHID,
  BK_PARTY_002_001,
  BM_M42850_001,
  TRANSACTION_DATE)
AS select 
STGMERGE.EDW_RECORD_NO,
STGMERGE.BCOLM_REC_TYPE,
STGMERGE.BCOLM_CORP,
STGMERGE.BCOLM_BATCH_NUMBER,
STGMERGE.BCOLM_SEQUENCE,
STGMERGE.BCOLM_DUAL_TYPE,
STGMERGE.BCOLM_TRAN_CHECK_NUMBER,
STGMERGE.BCOLM_TRAN_ACCOUNT,
STGMERGE.BCOLM_TRAN_DT,
STGMERGE.BCOLM_TRAN_AMOUNT,
STGMERGE.BCOLM_TRAN_REASON_CODE,
STGMERGE.BCOLM_TRAN_AUTH_NUMBER,
STGMERGE.BCOLM_TRAN_DESCRIPTION,
STGMERGE.BCOLM_TRAN_DESC_CODE,
STGMERGE.BCOLM_TRAN_DISPOSITION,
STGMERGE.BCOLM_TRAN_OPER,
STGMERGE.BCOLM_ONLINE_MON_IND,
NULLIF(STGMERGE.BCOLM_ORIG_POST_DT,'') AS BCOLM_ORIG_POST_DT,
NULLIF(STGMERGE.BCOLM_ORIG_TRAN_DT,'') AS BCOLM_ORIG_TRAN_DT,
NULLIF(STGMERGE.BCOLM_ORIG_AGGR_EFF_DT,'') AS BCOLM_ORIG_AGGR_EFF_DT,
STGMERGE.BCOLM_ORIG_ACCRUAL_IND,
STGMERGE.BCOLM_ORIG_TRAN_INIT_ACCR,
STGMERGE.FILLER_1,
COALESCE(STGMERGE.BCOLM_ORIG_TRAN_CODE,'') AS BCOLM_ORIG_TRAN_CODE,
STGMERGE.BCOLM_ORIG_REASON_CODE,
STGMERGE.BCOLM_ORIG_REF_NUMBER,
STGMERGE.BCOLM_DISPUTE_OPTION,
STGMERGE.BCOLM_DISPUTE_RESOLVE_OPTION,
STGMERGE.BCOLM_PLAN_ID,
STGMERGE.BCOLM_PLAN_SEQ,
STGMERGE.BCOLM_STORE_NBR,
STGMERGE.BCOLM_PMTS_FIXED,
STGMERGE.BCOLM_PAYMENTS_NBR,
STGMERGE.BCOLM_USER_CODE,
NULLIF(STGMERGE.BCOLM_INVOICE_NBR,'') AS BCOLM_INVOICE_NBR,
STGMERGE.BCOLM_MULTI_INVOICE_IND,
STGMERGE.BCOLM_USE_ORIG_REF_NBR,
STGMERGE.BCOLM_FRONT_LOAD_INTEREST_AMT,
STGMERGE.BCOLM_FRONT_LOAD_INSURANCE_AMT,
STGMERGE.BCOLM_FRONT_LOAD_INTEREST_RATE,
STGMERGE.BCOLM_TRAN_SOURCE_ID,
STGMERGE.BCOLM_SIC_CODE,
STGMERGE.FILLER_2,
STGMERGE.START_DT,
STGMERGE.END_DT,
STGMERGE.RECORD_DELETED_FLAG,
STGMERGE.CTL_ID,
STGMERGE.INS_PROC_NAME,
STGMERGE.INS_TXF_BATCHID,
STGMERGE.UPD_PROC_NAME,
STGMERGE.UPD_TXF_BATCHID,
null as BK_PARTY_002_001, /*not in mload*/
null as BM_M42850_001, /*not in mload*/
COALESCE(DEFAULT_DATE,to_date('1000-01-02', 'yyyy-MM-dd')) as TRANSACTION_DATE
FROM  p1dutedw.CHAR_CALENDAR CC
RIGHT OUTER JOIN
(
 SELECT
    EDW_RECORD_NO,
    BCOLM_REC_TYPE,
    BCOLM_CORP,
    BCOLM_BATCH_NUMBER,
    BCOLM_SEQUENCE,
    BCOLM_DUAL_TYPE,
    BCOLM_TRAN_CHECK_NUMBER,
    BCOLM_TRAN_ACCOUNT,
    BCOLM_TRAN_DT,
    BCOLM_TRAN_AMOUNT,
    BCOLM_TRAN_REASON_CODE,
    BCOLM_TRAN_AUTH_NUMBER,
    BCOLM_TRAN_DESCRIPTION,
    BCOLM_TRAN_DESC_CODE,
    BCOLM_TRAN_DISPOSITION,
    BCOLM_TRAN_OPER,
    BCOLM_ONLINE_MON_IND,
    BCOLM_ORIG_POST_DT,
    BCOLM_ORIG_TRAN_DT,
    BCOLM_ORIG_AGGR_EFF_DT,
    BCOLM_ORIG_ACCRUAL_IND,
    BCOLM_ORIG_TRAN_INIT_ACCR,
    FILLER_1,
    BCOLM_ORIG_TRAN_CODE,
    BCOLM_ORIG_REASON_CODE,
    BCOLM_ORIG_REF_NUMBER,
    BCOLM_DISPUTE_OPTION,
    BCOLM_DISPUTE_RESOLVE_OPTION,
    BCOLM_PLAN_ID,
    BCOLM_PLAN_SEQ,
    BCOLM_STORE_NBR,
    BCOLM_PMTS_FIXED,
    BCOLM_PAYMENTS_NBR,
    BCOLM_USER_CODE,
    BCOLM_INVOICE_NBR,
    BCOLM_MULTI_INVOICE_IND,
    BCOLM_USE_ORIG_REF_NBR,
    BCOLM_FRONT_LOAD_INTEREST_AMT,
    BCOLM_FRONT_LOAD_INSURANCE_AMT,
    BCOLM_FRONT_LOAD_INTEREST_RATE,
    BCOLM_TRAN_SOURCE_ID,
    BCOLM_SIC_CODE,
    FILLER_2,
    START_DT,
    END_DT,
    RECORD_DELETED_FLAG,
    CTL_ID,
    INS_PROC_NAME,
    INS_TXF_BATCHID,
    UPD_PROC_NAME,
    UPD_TXF_BATCHID
 FROM p1dsgedw.B2MTX_BCOMC_T_1_0_T1
) STGMERGE

ON COALESCE(BCOLM_TRAN_DT,'NA') = CC.CDT_YYYYMMDD
