CREATE OR REPLACE VIEW P1VTXEDW.VS1_EVENTDETAIL_01 (
  EVENT_ID,
  EVENT_START_DT,
  EVENT_DETAIL_TYPE_CD,
  EVENT_DETAIL_VAL)
AS SELECT
ICB_DB.EDW_RECORD_NO AS EVENT_ID
,TO_DATE(ICB_DB.CREATEDATE ,'yyyy-MM-dd') AS EVENT_START_DT
,M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD
,CAST(TRIM(COALESCE(ICB_DB.CHQNOBEGIN,''))||'_'||TRIM(COALESCE(ICB_DB.CHQNOEND,'')) AS VARCHAR(100))  AS EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_ICB_DB_1_0 AS ICB_DB

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349

WHERE  M44349.SOURCE_KEY = 'Cheque Number'
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

UNION ALL 

SELECT
ICB_DB.EDW_RECORD_NO AS EVENT_ID
,TO_DATE(ICB_DB.CREATEDATE ,'yyyy-MM-dd') AS EVENT_START_DT
,M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD
,ICB_DB.BOOKTYPE AS EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_ICB_DB_1_0 AS ICB_DB

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349

WHERE  M44349.SOURCE_KEY = 'Book Type'
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

UNION ALL 

  -----------------------------------------------------------------------------

SELECT
S1_BILL_DB_1_0.EDW_RECORD_NO AS EVENT_ID
,TO_DATE(S1_BILL_DB_1_0.CREATEDATE ,'yyyy-MM-dd') AS EVENT_START_DT
,M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD
,S1_BILL_DB_1_0.ISSCBPNLAUTH  AS EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_BILL_DB_1_0 AS S1_BILL_DB_1_0

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE   M44349.SOURCE_KEY = 'ISSCBPNLAUTH' -----( Y = Is Panal ,  Other value  = Not Panel )
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

UNION ALL 

  -----------------------------------------------------------------------------


SELECT
S1_BILL_DB_1_0.EDW_RECORD_NO AS EVENT_ID
,TO_DATE(S1_BILL_DB_1_0.CREATEDATE ,'yyyy-MM-dd') AS EVENT_START_DT
,M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD
,S1_BILL_DB_1_0.ISALERTSIGNER  AS EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_BILL_DB_1_0 AS S1_BILL_DB_1_0

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE   M44349.SOURCE_KEY = 'ISALERTSIGNER' ----- ( 1 = Enable , 0 = Disable )
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

UNION ALL 


SELECT
S1_BILL_CR_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_BILL_DB_1_0.SCHDEXECUTIONDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_BILL_CR_1_0.BILLERTYPE AS  VARCHAR(250)) AS EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_BILL_CR_1_0 AS S1_BILL_CR_1_0
JOIN P1VSTEDW.S1_BILL_DB_1_0 AS S1_BILL_DB_1_0

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE    M44349.SOURCE_KEY = 'BILLERTYPE'
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1


UNION ALL 


SELECT
S1_XFER_DB_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_DB_1_0.CREATEDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_XFER_DB_1_0.TYPE1  AS  VARCHAR(250)) AS EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_XFER_DB_1_0 AS S1_XFER_DB_1_0

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE    M44349.SOURCE_KEY = 'ACCOUNT SUB TYPE'  ---- ( 0 = Actual Account , 1 = Prompt Pay )
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

UNION ALL 


SELECT
S1_XFER_DB_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_DB_1_0.CREATEDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_XFER_DB_1_0.ISSCBPNLAUTH   AS  VARCHAR(250)) AS EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_XFER_DB_1_0 AS S1_XFER_DB_1_0

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE    M44349.SOURCE_KEY = 'ISSCBPNLAUTH' ---------- ( Y = Is Panal ,  Other value  = Not Panel )
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

UNION ALL 


SELECT
S1_XFER_DB_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_DB_1_0.CREATEDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_XFER_DB_1_0.ISALERTSIGNER   AS  VARCHAR(250)) AS EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_XFER_DB_1_0 AS S1_XFER_DB_1_0

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE  M44349.SOURCE_KEY ='ISALERTSIGNER' ---------- ( 1 = Enable , 0 = Disable )
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

UNION ALL 


SELECT
S1_XFER_DB_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_DB_1_0.CREATEDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_XFER_DB_1_0.UPDATEDTTM   AS  VARCHAR(250)) AS EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_XFER_DB_1_0 AS S1_XFER_DB_1_0

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE    M44349.SOURCE_KEY = 'XFER DEBIT UPDATEDTTM'
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

UNION ALL 


SELECT
S1_XFER_DB_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_DB_1_0.CREATEDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_XFER_DB_1_0.SCBFILEIMPORTID AS  VARCHAR(250))  AS   EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_XFER_DB_1_0 AS S1_XFER_DB_1_0

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE    M44349.SOURCE_KEY   = 'SCBFILEIMPORTID'
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

 -- /*
UNION ALL 


SELECT
S1_XFER_DB_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_DB_1_0.CREATEDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_XFER_DB_1_0.HOSTSTATUSCODE AS  VARCHAR(250))  AS   EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_XFER_DB_1_0 AS S1_XFER_DB_1_0

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE    M44349.SOURCE_KEY   = 'HOSTSTATUSCODE'
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

UNION ALL 


SELECT
S1_XFER_DB_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_DB_1_0.CREATEDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_XFER_DB_1_0.HOSTSEVERITY   AS  VARCHAR(250))  AS   EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_XFER_DB_1_0 AS S1_XFER_DB_1_0

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE    M44349.SOURCE_KEY   = 'HOSTSEVERITY'
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

UNION ALL 


SELECT
S1_XFER_DB_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_DB_1_0.CREATEDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_XFER_DB_1_0.HOSTDESCRIPTION   AS  VARCHAR(250))  AS   EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_XFER_DB_1_0 AS S1_XFER_DB_1_0

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE    M44349.SOURCE_KEY   = 'HOSTDESCRIPTION'
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

UNION ALL 


SELECT
S1_XFER_CR_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_DB_1_0.SCHDEXECUTIONDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_XFER_CR_1_0.UPDATEDTTM   AS  VARCHAR(250))  AS   EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_XFER_CR_1_0 AS S1_XFER_CR_1_0
INNER JOIN  P1VSTEDW.S1_XFER_DB_1_0 AS  S1_XFER_DB_1_0
 ON   S1_XFER_DB_1_0.TRANSACTIONID = S1_XFER_CR_1_0.TRANSACTIONID

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE    M44349.SOURCE_KEY   = 'XFER CREDIT UPDATEDTTM'          
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

UNION ALL 

SELECT
S1_XFER_FEE_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_DB_1_0.SCHDEXECUTIONDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_XFER_FEE_1_0.FEECODE   AS  VARCHAR(250))  AS   EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_XFER_FEE_1_0 AS S1_XFER_FEE_1_0

INNER JOIN  P1VSTEDW.S1_XFER_DB_1_0 AS  S1_XFER_DB_1_0
ON  S1_XFER_DB_1_0.TRANSACTIONID = S1_XFER_FEE_1_0.TRANREF                       

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE    M44349.SOURCE_KEY   = 'FEECODE'
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

UNION ALL 

 -----------------------------------------------------------------------------
 -- VIEW NAME     :  VS1_EVENTDETAILBILLDB_07,VS1_EVENTDETAILBILLDB_08
 -- STAGING TABLE : 1.S1_XFER_DB_1_0,S1_XFER_FEE_1_0

 -------------------------------------------------------------------------------
SELECT
S1_XFER_FEE_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_DB_1_0.SCHDEXECUTIONDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
 --CAST(TO_DATE(S1_XFER_FEE_1_0.UPDATEDTTM, 'yyyy-MM-dd')   AS  VARCHAR(250))  AS   EVENT_DETAIL_VAL   --SIT EDIT
CAST(S1_XFER_FEE_1_0.UPDATEDTTM AS VARCHAR(250))  AS   EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_XFER_FEE_1_0 AS S1_XFER_FEE_1_0

INNER JOIN  P1VSTEDW.S1_XFER_DB_1_0 AS  S1_XFER_DB_1_0
ON  S1_XFER_DB_1_0.TRANSACTIONID = S1_XFER_FEE_1_0.TRANREF                       

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE    M44349.SOURCE_KEY   = 'XFER FEE UPDATEDTTM'           
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

  -- /*
 -- UNION ALL 
 -- -----------------------------------------------------------------------------
 -- -- VIEW NAME     :  VS1_EVENTDETAILBILLDB_03
 -- -- STAGING TABLE : 1. S1_XFER_DB_1_0,S1_XFER_FEE_1_0,S1_XFER_HOSTRESP_1_0   
 -- -------------------------------------------------------------------------------
 -- SELECT
 -- S1_XFER_FEE_1_0.EDW_RECORD_NO AS EVENT_ID,
 -- TO_DATE(S1_XFER_DB_1_0.SCHDEXECUTIONDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
 -- M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
 -- CAST(S1_XFER_HOSTRESP_1_0.HOSTRESPTYPE   AS  VARCHAR(250))  AS   EVENT_DETAIL_VAL   
 -- 
 -- FROM P1VSTEDW.S1_XFER_DB_1_0 AS S1_XFER_DB_1_0
 -- 
 -- INNER JOIN  P1VSTEDW.S1_XFER_FEE_1_0 AS  S1_XFER_FEE_1_0
 -- ON  S1_XFER_DB_1_0.TRANSACTIONID = S1_XFER_FEE_1_0.TRANREF    
 -- 
 -- INNER JOIN P1VSTEDW.S1_XFER_HOSTRESP_1_0 AS  S1_XFER_HOSTRESP_1_0
 -- ON  S1_XFER_FEE_1_0.TRANREF = S1_XFER_HOSTRESP_1_0.TRANSACTIONID
 -- 
 -- CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
 -- WHERE  M44349.SOURCE_KEY   = 'HOSTRESPTYPE'           
 -- AND M44349.SRC_CTL_ID = '051'
 -- AND M44349.SOURCE_ID = 1
 -- */

UNION ALL 

 -----------------------------------------------------------------------------
 -- VIEW NAME     :  VS1_EVENTDETAILBILLDB_04
 -- STAGING TABLE : 1. S1_XFER_DB_1_0,S1_XFER_FEE_1_0,S1_XFER_HOSTRESP_1_0   

 -------------------------------------------------------------------------------
SELECT
S1_XFER_FEE_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_DB_1_0.SCHDEXECUTIONDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_XFER_FEE_1_0.HOSTSTATUSCODE   AS  VARCHAR(250))  AS   EVENT_DETAIL_VAL 

FROM P1VSTEDW.S1_XFER_DB_1_0 AS S1_XFER_DB_1_0

INNER JOIN  P1VSTEDW.S1_XFER_FEE_1_0 AS  S1_XFER_FEE_1_0
ON  S1_XFER_DB_1_0.TRANSACTIONID = S1_XFER_FEE_1_0.TRANREF


CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE M44349.SOURCE_KEY   = 'HOSTSTATUSCODE'          
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

UNION ALL 


SELECT
S1_XFER_FEE_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_DB_1_0.SCHDEXECUTIONDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_XFER_FEE_1_0.HOSTSEVERITY    AS  VARCHAR(250))  AS   EVENT_DETAIL_VAL 

FROM P1VSTEDW.S1_XFER_DB_1_0 AS S1_XFER_DB_1_0

INNER JOIN  P1VSTEDW.S1_XFER_FEE_1_0 AS  S1_XFER_FEE_1_0
ON  S1_XFER_DB_1_0.TRANSACTIONID = S1_XFER_FEE_1_0.TRANREF


CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE M44349.SOURCE_KEY   = 'HOSTSEVERITY'           
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1

UNION ALL 


SELECT
S1_XFER_FEE_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_DB_1_0.SCHDEXECUTIONDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_XFER_FEE_1_0.HOSTDESCRIPTION  AS  VARCHAR(250))  AS   EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_XFER_DB_1_0 AS S1_XFER_DB_1_0

INNER JOIN P1VSTEDW.S1_XFER_FEE_1_0 AS  S1_XFER_FEE_1_0
ON  S1_XFER_DB_1_0.TRANSACTIONID = S1_XFER_FEE_1_0.TRANREF


CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE M44349.SOURCE_KEY   = 'HOSTDESCRIPTION'
AND M44349.SRC_CTL_ID = '051'

UNION ALL

SELECT
S1_XFER_CR_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_CR_1_0.SCHDEXECUTIONDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_XFER_CR_1_0.TYPEOFPAYEE AS VARCHAR(250)) AS EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_XFER_CR_1_0 AS S1_XFER_CR_1_0
LEFT OUTER JOIN P1VSTEDW.S1_XFER_DB_1_0 AS  S1_XFER_DB_1_0
ON S1_XFER_DB_1_0.TRANSACTIONID = S1_XFER_CR_1_0.TRANSACTIONID

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE M44349.SOURCE_KEY = 'METHOD TYPE OF RECEIVER'          
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1
AND COALESCE(TRIM(S1_XFER_CR_1_0.TYPEOFPAYEE),'')<>''

UNION ALL

SELECT
S1_XFER_DB_1_0.EDW_RECORD_NO AS EVENT_ID,
TO_DATE(S1_XFER_DB_1_0.CREATEDATE ,'yyyy-MM-dd') AS EVENT_START_DT,
M44349.EDW_CODE AS EVENT_DETAIL_TYPE_CD,
CAST(S1_XFER_DB_1_0.TYPEOFPAYER AS VARCHAR(250)) AS EVENT_DETAIL_VAL

FROM P1VSTEDW.S1_XFER_DB_1_0 AS S1_XFER_DB_1_0
LEFT OUTER JOIN P1VSTEDW.S1_XFER_CR_1_0 AS S1_XFER_CR_1_0
ON S1_XFER_DB_1_0.TRANSACTIONID = S1_XFER_CR_1_0.TRANSACTIONID

CROSS JOIN P1VUTEDW.M44349_EVENT_DETAIL_TYPE AS M44349
WHERE M44349.SOURCE_KEY = 'METHOD TYPE OF SENDER'          
AND M44349.SRC_CTL_ID = '051'
AND M44349.SOURCE_ID = 1
AND COALESCE(TRIM(S1_XFER_DB_1_0.TYPEOFPAYER),'')<>''
